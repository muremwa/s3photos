(this.webpackJsonps3photosf=this.webpackJsonps3photosf||[]).push([[0],{53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t),n.d(t,"loadPostsUrl",(function(){return K})),n.d(t,"uploadPostUrl",(function(){return J})),n.d(t,"token",(function(){return Y})),n.d(t,"icons",(function(){return z}));var a=n(0),r=n.n(a),s=n(25),c=n.n(s),o=n(9),i=n(15),l=n(6),u=(n(53),n(54),n(13)),d=n(27),j=n(19),p=n(12),h=n(33);function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.replace(/\?/g,"");return new Map(t.split("&").map((function(e){return e.split("=")})))}n(55);var m=n(1);function f(e){var t=Object(l.f)(),n=Object(l.g)(),r=Object(a.useState)(""),s=Object(u.a)(r,2),c=s[0],o=s[1],f="top-nav";return Object(a.useEffect)((function(){var e=b(n.search);e.has("post-query")&&o(e.get("post-query"));var t=document.getElementById(f);t&&t.scrollIntoView()}),[n]),Object(m.jsxs)(d.a,{bg:"dark",variant:"dark",expand:"lg",id:f,children:[Object(m.jsx)(d.a.Brand,{href:"/",children:"S3photos"}),Object(m.jsx)(d.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(m.jsxs)(d.a.Collapse,{id:"basic-navbar-nav",children:[Object(m.jsxs)(h.a,{className:"mr-auto",children:[Object(m.jsx)(h.a.Item,{children:Object(m.jsx)(i.b,{className:"nav-link",to:"/",exact:!0,children:"Home"})}),Object(m.jsx)(h.a.Item,{children:Object(m.jsx)(i.b,{className:"nav-link",to:"/upload/",exact:!0,children:"Upload"})})]}),Object(m.jsxs)(p.a,{inline:!0,onSubmit:function(e){e.preventDefault();var n=e.target.children.search.value;t.push("/?post-query=".concat(n))},children:[Object(m.jsx)(p.a.Control,{name:"search",type:"text",defaultValue:c,placeholder:"Search for posts, uploader and tags",className:"mr-sm-2",required:!0}),Object(m.jsx)(j.a,{type:"submit",variant:"outline-success",children:"Search"})]})]})]})}var O=n(47),v=n(42),x=n(43),g=n(48),k=n(46),y=n(44),N=new(n(45).Dispatcher),C=new(function(e){Object(g.a)(n,e);var t=Object(k.a)(n);function n(){var e;Object(v.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).posts=[],e.likedPosts=[],e.loaded=!1,e.cases={HUNGARIAN_NOTATION:"HN",NORMAL_CASE:"NC",CAMEL_CASE:"CC",SNAKE_CASE:"SC"},e}return Object(x.a)(n,[{key:"caseChanger",value:function(e,t,n){if([e,t,n].some((function(e){return void 0===e})))throw new Error("Missing arguments");if([e,t,n].some((function(e){return"string"!==typeof e})))throw new Error("Wrong argument type");if((t=t.toUpperCase())===(n=n.toUpperCase()))return e;var a,r;switch(t){case this.cases.CAMEL_CASE:case this.cases.HUNGARIAN_NOTATION:a=e.split(/([A-Z]{1}[a-z]*)/).filter(Boolean);break;case this.cases.SNAKE_CASE:a=e.split("_");break;case this.cases.NORMAL_CASE:a=e.split(/\s/);break;default:throw new Error("Converting from '".concat(t,"' not supported"))}switch(n){case this.cases.CAMEL_CASE:r=a.map((function(e){return"".concat(e[0].toUpperCase()).concat(e.substring(1).toLowerCase())})).join("");break;case this.cases.HUNGARIAN_NOTATION:r=a.map((function(e,t){return e=e.toLowerCase(),t>0&&(e="".concat(e[0].toUpperCase()).concat(e.substring(1).toLowerCase())),e})).join("");break;case this.cases.SNAKE_CASE:r=a.map((function(e){return e.toLowerCase()})).join("_");break;case this.cases.NORMAL_CASE:r=a.map((function(e){return e.toLowerCase()})).join(" ");break;default:throw new Error("Converting to '".concat(n,"' not supported"))}return r}},{key:"getPostLikes",value:function(e){var t=this.posts.find((function(t){return t.id===e}));return t?{likes:t.likes,liked:t.liked}:null}},{key:"cleanPost",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.likedPosts.includes(t.id),a={liked:n},r=Object.keys(t).map((function(t){return e.caseChanger(t,e.cases.SNAKE_CASE,e.cases.HUNGARIAN_NOTATION)}));return Object.values(t).forEach((function(e,t){a[r[t]]=e})),a}},{key:"handleActions",value:function(e){var t=this;switch(e.type){case"LOADED_POSTS":this.likedPosts=e.payload.liked,this.posts=Array.isArray(e.payload.posts)?e.payload.posts.map((function(e){return t.cleanPost(e)})):[],this.loaded=!0,this.emit("change");break;case"LIKED_POST":var n=this.posts.find((function(t){return t.id===e.payload.postId}));n&&(n.likes=e.payload.likes>-1?e.payload.likes:n.likes,n.liked=e.payload.status),this.emit("change_to_post_".concat(e.payload.postId))}}}]),n}(y.EventEmitter));N.register(C.handleActions.bind(C));var E=C,w=function(){var e="POST",t="GET",n={name:"Access-Control-Allow-Origin",value:"*"},a=new XMLHttpRequest;function r(e){var t;!0===e.sendCookies&&(a.withCredentials=!0),e.headers&&e.headers.length>0&&(t=e.headers,e.crosssite&&t.push(n),t.forEach((function(e){a.setRequestHeader(e.name,e.value)}))),a.responseType=e.responseType,a.onerror=e.error,a.onload=function(t){var n;200===(n=a.status,parseInt(n.toString().replace(/\B\d/g,"0")))?e.success({status:a.status,statusText:a.statusText,response:a.response}):e.error(t)}}return{get:function(e){return function(e){if(e.params){if("string"===typeof e.url&&(e.url=new URL(e.url)),!("searchParams"in e.url))throw TypeError("The url passed is incorrect");e.params.forEach((function(t){e.url.searchParams.set(t.name,t.value)}))}a.open(t,e.url),e.downloadprogress&&(a.onprogress=function(t){t.lengthComputable?e.downloadprogress(t.lengthComputable,t.loaded,t.total):e.downloadprogress(t.lengthComputable,t.loaded)}),r(e),a.send()}(e)},post:function(t){return function(t){if(t.data&&t.form)throw new Error("Both data and form are currently not supported");a.open(e,t.url);var n="";if(t.data){var s={name:"Content-Type",value:"application/json; charset=utf-8"};t.headers?t.headers.push(s):t.headers=[s],n=t.data}else t.form&&(n=new FormData(t.form));r(t),t.uploadstart&&(a.upload.onloadstart=t.uploadstart),t.uploadend&&(a.upload.onload=t.uploadend),t.uploaderror&&(a.upload.onerror=t.uploaderror),t.uploadprogress&&(a.upload.onprogress=function(e){t.uploadprogress(e.loaded,e.total)}),a.send(n)}(t)}}}();n(65);function A(e){var t=e.error,n=e.reloader;return Object(m.jsxs)("div",{className:"container",id:"no-posts",children:[Object(m.jsxs)("div",{className:"text-center",children:[Object(m.jsxs)("h2",{children:["No posts availble at this moment ",e.from?"from ".concat(e.from):void 0]}),Object(m.jsxs)(i.b,{to:"".concat(e.from?"/upload/?as=".concat(e.from):"/upload/"),className:"btn btn-dark upload-btn",exact:!0,children:["Upload to ",Object(m.jsx)("span",{className:"s3",children:"S3photos"})," ",e.from?"as ".concat(e.from):void 0]})]}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"text-center",children:Object(m.jsxs)(j.a,{onClick:n,variant:t?"danger":"dark",children:[t?"An error occured ":"","Click to reload"]})})]})}function S(e){var t=e.likes,n=e.likingUrl,r=e.liked,s=e.id,c=e.line,o=Object(a.useState)(r),i=Object(u.a)(o,2),l=i[0],d=i[1],j=Object(a.useState)(t),p=Object(u.a)(j,2),h=p[0],b=p[1],f="like-btn-".concat(s),O=function(){var e=E.getPostLikes(s);null!==e&&(d(e.liked),b(e.likes))};return Object(a.useEffect)((function(){return E.on("change_to_post_".concat(s),O),function(){return E.removeListener("change_to_post_".concat(s),O)}})),Object(m.jsxs)("form",{className:"like",onSubmit:function(e){e.preventDefault(),c(97,!1),function(e,t,n,a){var r={url:e,responseType:"json",form:t,error:a,success:function(e){var t=e.response,r=Object.keys(t);N.dispatch({type:"LIKED_POST",payload:{postId:n,status:!!r.includes("liked")&&t.liked,likes:r.includes("likes")?t.likes:-1}}),a()}};w.post(r)}(n,e.target,s,(function(){return c(0,!0)}))},children:[Object(m.jsx)("input",{type:"hidden",name:"csrfmiddlewaretoken",value:Y}),Object(m.jsx)("img",{type:"image",src:l?z.heartFull:z.heart,alt:"like vector",className:"vector liking",onClick:function(){var e=document.getElementById(f);e&&e.click()}}),Object(m.jsx)("input",{type:"submit",hidden:!0,id:f}),Object(m.jsxs)("span",{className:"h-m-l",name:"count",children:[" ",h]})]})}function _(e){var t,n=e.caption,a=e.imageFile,r=e.likes,s=e.likingUrl,c=e.cleanTime,o=e.uploadedBy,l=e.id,u=e.liked,d=e.line;return Object(m.jsxs)(O.a,{className:"post",id:"post-".concat(l),children:[Object(m.jsx)("img",{src:a,alt:"Post by ".concat(o)}),Object(m.jsxs)("div",{className:"post-info",children:[Object(m.jsxs)("div",{className:"info-post",children:[Object(m.jsx)("div",{className:"uploader",children:Object(m.jsxs)("span",{className:"uploader-info",children:[Object(m.jsx)("img",{className:"user-vector vector",src:z.user,alt:"user-vector"}),Object(m.jsx)(i.b,{to:"/?post-query=".concat(o),className:"uploader-name",children:o})]})}),Object(m.jsxs)("div",{className:"date",children:[Object(m.jsx)("img",{src:z.clock,alt:"clock-vector",className:"clock-vector vector"}),Object(m.jsx)("span",{className:"posted-time",children:(t=c,t.replace(/\s0/g," ").replace(/AM/,"a.m.").replace(/PM/,"p.m."))})]})]}),Object(m.jsx)("div",{className:"caption",children:Object(m.jsx)("p",{children:n})}),Object(m.jsx)(S,{likes:r,likingUrl:s,id:l,liked:u,line:d})]})]})}function T(e){var t=e.line,n=Object(l.g)(),r=Object(a.useState)(E.posts),s=Object(u.a)(r,2),c=s[0],i=s[1],d=Object(a.useState)(!0),j=Object(u.a)(d,2),p=j[0],h=j[1],f=Object(a.useState)(!1),O=Object(u.a)(f,2),v=O[0],x=O[1],g=c.map((function(e,n){return Object(m.jsx)(_,Object(o.a)(Object(o.a)({},e),{},{line:t}),"".concat(e.id,"-").concat(n))})),k=b(e.location.search);p&&(t(95,!1),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n={url:e?"".concat(K,"?post-query=").concat(e):K,responseType:"json",error:function(){return t(!0)},success:function(e){e.response&&N.dispatch({type:"LOADED_POSTS",payload:{posts:e.response.posts,liked:e.response.liked}}),t(!1)}};w.get(n)}(k.has("post-query")?k.get("post-query"):null,(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t(0,!0),e&&x(!0)})),h(!1));var y=function(){i(E.posts)};return Object(a.useEffect)((function(){h(!0)}),[n]),Object(a.useEffect)((function(){return E.on("change",y),function(){return E.removeListener("change",y)}})),document.title="S3photos | all posts",Object(m.jsx)("div",{className:"every",children:g.length>0?g:Object(m.jsx)(A,{from:k.has("post-query")?k.get("post-query"):null,error:v,reloader:function(){return h(!0)}})})}var I=n(28);n(66);function L(e){return Object(m.jsx)(I.a,{id:e.id?e.id:"",className:e.classNameExtra?e.classNameExtra:"",variant:"warning",children:e.message})}function P(e){var t=e.error,n=e.me,a="file-alert",r="image-to-upload",s="image-to-call";return null===n||n(a),Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{className:"img-to-up",id:r,children:[Object(m.jsx)("h6",{className:"text-center",children:"You are about to upload the image below"}),Object(m.jsx)("img",{id:s,src:"",alt:"To be uploaded"})]}),t?Object(m.jsx)(L,{id:a,message:t}):Object(m.jsx)(I.a,{id:a,variant:"info",children:"Choose an image"}),Object(m.jsxs)(p.a.Group,{children:[Object(m.jsx)(p.a.Label,{children:"File"}),Object(m.jsx)(p.a.File,{name:"file",accept:"image/*",className:"form-control",onChange:function(e){var t=document.getElementById(s),n=document.getElementById(r),c=document.getElementById(a),o=new FileReader;o.onload=function(e){t.src=e.target.result},o.readAsDataURL(e.target.files[0]),n&&(n.style.display="block"),c&&(c.style.display="none")},required:!0})]})]})}function U(e){var t=e.error,n=e.name,a=e.help,r=e.x_name,s=e.dValue,c=e.me,o="your-name-error";return null===c||c(o),Object(m.jsxs)("div",{children:[t?Object(m.jsx)(L,{message:t,id:o}):Object(m.jsx)(I.a,{variant:"info",children:a}),Object(m.jsxs)(p.a.Group,{children:[Object(m.jsx)(p.a.Label,{children:r}),Object(m.jsx)(p.a.Control,{defaultValue:s,name:n,required:!0})]})]})}function q(e){var t=e.error,n=e.name,a=e.help,r=e.x_name,s=e.dValue,c=e.me,o="caption-error-id";return null===c||c(o),Object(m.jsxs)("div",{children:[t?Object(m.jsx)(L,{id:o,message:t}):Object(m.jsx)(I.a,{variant:"info",children:a}),Object(m.jsxs)(p.a.Group,{children:[Object(m.jsx)(p.a.Label,{children:r}),Object(m.jsx)(p.a.Control,{defaultValue:s,as:"textarea",rows:"10",name:n,required:!0})]})]})}function B(e){return e.me&&e.me(e.id),Object(m.jsxs)("div",{className:"text-center",children:[Object(m.jsx)(L,{id:e.id,classNameExtra:"text-center error",message:e.unexpected?"An unexpected error occurred":"Please correct the errors below"}),e.unexpected?Object(m.jsx)(j.a,{onClick:e.reload,variant:"dark",children:"Refresh to try again"}):null]})}function D(e){var t=b(e.location.search),n=e.line,r=e.reload,s="main-error-id",c={dValue:t.has("as")?t.get("as"):"",x_name:"Your name",name:"your_name",help:"Enter a name you would like to be known as"},i=Object(a.useState)({file:null,caption:null,your_name:null,unexpected:!1}),l=Object(u.a)(i,2),d=l[0],p=l[1],h=Object.values(d).some((function(e){return Boolean(e)})),f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return p(e)},O=function(){return n(0,!0)},v=function(t){return e.history.push("/")},x=function(e){return n(e,!1)},g=d.unexpected?0:d.file?1:d.caption?2:d.your_name?3:null,k=function(e){var t=document.getElementById(e);t&&t.scrollIntoView()};return 0===g&&k(s),Object(m.jsx)("div",{className:"cloud",children:Object(m.jsxs)("form",{method:"POST",id:"form-upload",encType:"multipart/form-data",onSubmit:function(e){e.preventDefault(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},s={url:J,responseType:"json",form:e,error:function(){r({unexpected:!0}),a()},success:function(e){var t=e.response;if(t.success)n();else{var s={};Object.keys(t.errors).forEach((function(e){return s[e]=t.errors[e][0]})),r(s),a()}},uploadprogress:function(e,n){t(e/n*100)}};w.post(s)}(e.target,x,v,O,f)},children:[Object(m.jsxs)("legend",{className:"text-center legend-form",children:["Upload an image to ",Object(m.jsx)("span",{className:"s3",children:"S3photos"}),t.has("as")?" as ".concat(t.get("as")):void 0]}),Object(m.jsx)("input",{type:"hidden",value:Y,name:"csrfmiddlewaretoken"}),h?Object(m.jsx)(B,{id:s,unexpected:d.unexpected,me:0===g?k:null,reload:r}):void 0,Object(m.jsx)(P,{error:d.file,me:1===g?k:null}),Object(m.jsx)("hr",{}),Object(m.jsx)(q,Object(o.a)(Object(o.a)({},{dValue:"",x_name:"Caption",name:"caption",help:"Tell others what the image is about"}),{},{error:d.caption,me:2===g?k:null})),Object(m.jsx)("hr",{}),Object(m.jsx)(U,Object(o.a)(Object(o.a)({},c),{},{error:d.your_name,me:3===g?k:null})),Object(m.jsx)("hr",{}),Object(m.jsxs)(j.a,{type:"submit",variant:"dark",children:["Upload to ",Object(m.jsx)("span",{className:"s3",children:"S3photos"})]})]})})}function R(e){var t=e.connection;return Object(m.jsxs)("div",{className:"text-center",children:[Object(m.jsx)("h1",{children:t?"":"No Connection available"}),t?null:Object(m.jsx)(j.a,{onClick:e.reload,children:"Click to retry"})]})}function F(e){var t=Object(a.useState)(!1),n=Object(u.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)(!0),i=Object(u.a)(c,2),l=i[0],d=i[1],j=function(){return s(!1)};r||(e.line(98,!1),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a={url:J,responseType:"json",error:function(){n(),e()},success:function(){t(),e()}};w.get(a)}((function(){return e.line(0,!0)}),(function(){s(!0),d(!0)}),(function(){s(!0),d(!1)})));return document.title="S3photos | upload",r?l?Object(m.jsx)(D,Object(o.a)(Object(o.a)({},e),{},{reload:j})):Object(m.jsx)(R,{connection:!1,reload:j}):Object(m.jsx)(R,{connection:!0})}function M(e){return console.log(e),Object(m.jsxs)("div",{id:"main",class:"text-center",children:[Object(m.jsx)("h1",{children:"404 error"}),Object(m.jsx)("h2",{children:"the page you requested does not exist"}),Object(m.jsx)(i.b,{className:"btn btn-dark",to:"/",children:"Home"})]})}var H=function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.getElementById("line-load");t?n&&(n.style.width="0%"):e<101&&e>-1&&n&&(n.style.width="".concat(e,"%"))};return Object(m.jsx)("div",{children:Object(m.jsxs)(i.a,{basename:"/open/",children:[Object(m.jsx)(f,{}),Object(m.jsx)("div",{id:"load-line",children:Object(m.jsx)("div",{id:"line-load"})}),Object(m.jsxs)(l.c,{children:[Object(m.jsx)(l.a,{path:"/",exact:!0,render:function(t){return Object(m.jsx)(T,Object(o.a)(Object(o.a)({},t),{},{line:e}))}}),Object(m.jsx)(l.a,{path:"/upload/",exact:!0,render:function(t){return Object(m.jsx)(F,Object(o.a)(Object(o.a)({},t),{},{line:e}))}}),Object(m.jsx)(l.a,{component:M})]})]})})},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,69)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),s(e),c(e)}))},G=document.getElementById("root"),K=G.dataset.loadPosts,J=G.dataset.uploadPost,Y=G.dataset.token,z={user:G.dataset.userIcon,clock:G.dataset.timeIcon,heart:G.dataset.heartIcon,heartFull:G.dataset.heartFullIcon};c.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(H,{})}),G),V()}},[[67,1,2]]]);
//# sourceMappingURL=main.64faccb0.chunk.js.map